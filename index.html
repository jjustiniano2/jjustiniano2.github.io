<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Frames â†’ Video: Orderâ€‘based Demo</title>
  <style>
    :root { --bg:#0b0c10; --panel:#111318; --ink:#e6e7ea; --muted:#a3a6ad; --accent:#5cc8ff; --border:#22252d; }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif}
    .wrap{max-width:980px;margin:40px auto;padding:0 16px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}
    h1{font-size:20px;margin:0}
    .card, .slot{background:var(--panel);border:1px dashed var(--border);border-radius:14px}
    .palette{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:18px}
    .card{cursor:grab;display:flex;flex-direction:column;gap:8px;padding:10px;user-select:none;box-shadow:0 1px 0 rgba(0,0,0,.2)}
    .card:active{cursor:grabbing}
    .card img{width:100%;aspect-ratio:16/10;object-fit:cover;border-radius:10px;background:#1a1d24}
    .card .label{font-size:12px;color:var(--muted);text-align:center}

    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:8px 0 6px}
    .slot{min-height:140px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
    .slot .slot-label{position:absolute;top:8px;left:10px;font-size:12px;color:var(--muted)}
    .slot.drag-over{outline:2px solid var(--accent);outline-offset:-2px}
    .slot .card{border-style:solid}

    .actions{display:flex;gap:10px;align-items:center;margin:6px 0 18px}
    button{appearance:none;border:1px solid var(--border);background:#171a21;color:var(--ink);border-radius:10px;padding:8px 12px;font-size:14px}
    button:hover{border-color:#2a2e38}
    .hint{font-size:13px;color:var(--muted)}

    .player{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:12px}
    video{width:100%;max-height:60vh;border-radius:10px;background:#000}
    .order{font-size:13px;color:var(--muted);margin:8px 0 0}

    footer{margin:30px 0 10px;color:var(--muted);font-size:12px}
    code{background:#0e1116;padding:0 .3em;border-radius:6px}
    .accent{color:var(--accent)}
  </style>
</head>
<body>
  <!--
    ðŸ“‚ Required files you must add to your repo alongside this index.html:

    assets/images/img1.jpg
    assets/images/img2.jpg
    assets/images/img3.jpg

    assets/videos/video-123.mp4
    assets/videos/video-132.mp4
    assets/videos/video-213.mp4
    assets/videos/video-231.mp4
    assets/videos/video-312.mp4
    assets/videos/video-321.mp4

    File naming rule: when the slots (1â†’2â†’3) hold images with IDs [1,2,3], we load assets/videos/video-123.mp4, etc.
    Change the mapping in JS below if you want custom filenames.
  -->

  <div class="wrap">
    <header>
      <h1>ðŸ§© Arrange the 3 frames â†’ see a different video</h1>
      <div class="hint">Drag from the <span class="accent">Image Tray</span> into the three positions.</div>
    </header>

    <h3 class="hint" style="margin:0 0 6px">Image Tray</h3>
    <div id="palette" class="palette" aria-label="Image tray (drag items from here)">
      <div class="card" draggable="true" data-id="1" aria-grabbed="false">
        <img src="assets/images/img1.jpg" alt="Image 1" />
        <div class="label">Image 1</div>
      </div>
      <div class="card" draggable="true" data-id="2" aria-grabbed="false">
        <img src="assets/images/img2.jpg" alt="Image 2" />
        <div class="label">Image 2</div>
      </div>
      <div class="card" draggable="true" data-id="3" aria-grabbed="false">
        <img src="assets/images/img3.jpg" alt="Image 3" />
        <div class="label">Image 3</div>
      </div>
    </div>

    <h3 class="hint" style="margin:10px 0 6px">Positions</h3>
    <div class="grid" role="list" aria-label="Drop zones">
      <div class="slot" data-slot="1" role="listitem" aria-label="Position 1">
        <span class="slot-label">Position 1</span>
      </div>
      <div class="slot" data-slot="2" role="listitem" aria-label="Position 2">
        <span class="slot-label">Position 2</span>
      </div>
      <div class="slot" data-slot="3" role="listitem" aria-label="Position 3">
        <span class="slot-label">Position 3</span>
      </div>
    </div>

    <div class="actions">
      <button id="reset">Reset</button>
      <div id="orderInfo" class="order">Drag images into all three positions to preview the video.</div>
    </div>

    <div class="player">
      <video id="resultVideo" controls preload="metadata" playsinline>
        <source src="" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>

    <footer>
      <div>Tip: encode videos as H.264 (yuv420p) MP4 for best compatibility.</div>
      <div>Example ffmpeg: <code>ffmpeg -r 24 -i frame%03d.png -pix_fmt yuv420p -c:v libx264 -preset veryfast assets/videos/video-123.mp4</code></div>
    </footer>
  </div>

  <script>
    // Optional: set this to a mapping if your video filenames don't follow the pattern "video-123.mp4".
    // Example: const VIDEO_MAP = { "132": "assets/videos/custom-name.mp4" };
    const VIDEO_MAP = null;

    const palette = document.getElementById('palette');
    const slots = Array.from(document.querySelectorAll('.slot'));
    const info = document.getElementById('orderInfo');
    const video = document.getElementById('resultVideo');

    // --- Drag helpers ---
    function handleDragStart(e){
      const card = e.currentTarget;
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/plain', card.dataset.id);
      const origin = card.closest('.slot') ? `slot-${card.closest('.slot').dataset.slot}` : 'palette';
      e.dataTransfer.setData('origin', origin);
      requestAnimationFrame(()=> card.classList.add('dragging'));
    }
    function handleDragEnd(e){
      e.currentTarget.classList.remove('dragging');
    }

    function allowDrop(e){ e.preventDefault(); e.dataTransfer.dropEffect = 'move'; }
    function highlight(e){ e.currentTarget.classList.add('drag-over'); }
    function unhighlight(e){ e.currentTarget.classList.remove('drag-over'); }

    function dropOnPalette(e){
      e.preventDefault();
      const id = e.dataTransfer.getData('text/plain');
      const origin = e.dataTransfer.getData('origin');
      const card = document.querySelector(`.card[data-id="${id}"]`);
      if (!card) return;
      if (origin.startsWith('slot-')){
        // Removing from its original slot is implicit when we append to palette
      }
      palette.appendChild(card);
      updateOrderAndVideo();
    }

    function dropOnSlot(e){
      e.preventDefault();
      const targetSlot = e.currentTarget;
      const id = e.dataTransfer.getData('text/plain');
      const origin = e.dataTransfer.getData('origin');
      const card = document.querySelector(`.card[data-id="${id}"]`);
      if (!card) return;

      // If this slot already has a card, return it to the palette first
      const existing = targetSlot.querySelector('.card');
      if (existing) palette.appendChild(existing);

      // Move the dragged card here (removes it from palette or its previous slot)
      targetSlot.appendChild(card);
      updateOrderAndVideo();
    }

    function updateOrderAndVideo(){
      const order = slots.map(slot => {
        const card = slot.querySelector('.card');
        return card ? card.dataset.id : null;
      });
      if (order.every(Boolean)){
        const key = order.join('');
        info.textContent = `Order: ${order.join(' â†’ ')}`;
        const src = (VIDEO_MAP && VIDEO_MAP[key]) ? VIDEO_MAP[key] : `assets/videos/video-${key}.mp4`;
        const source = video.querySelector('source');
        if (source.src !== new URL(src, location.href).href){
          source.src = src;
          video.load();
          video.play().catch(()=>{});
        }
      } else {
        info.textContent = 'Drag images into all three positions to preview the video.';
        const source = video.querySelector('source');
        if (source.src){
          video.pause();
          source.src = '';
          video.load();
        }
      }
    }

    // Wire up drag events for current and future cards
    function attachCardEvents(card){
      card.addEventListener('dragstart', handleDragStart);
      card.addEventListener('dragend', handleDragEnd);
    }
    document.querySelectorAll('.card').forEach(attachCardEvents);

    // Make palette and slots droppable
    palette.addEventListener('dragover', allowDrop);
    palette.addEventListener('drop', dropOnPalette);
    slots.forEach(slot => {
      slot.addEventListener('dragover', allowDrop);
      slot.addEventListener('dragenter', highlight);
      slot.addEventListener('dragleave', unhighlight);
      slot.addEventListener('drop', (e)=>{ unhighlight(e); dropOnSlot(e); });
    });

    // Reset button
    document.getElementById('reset').addEventListener('click', () => {
      slots.forEach(slot => {
        const card = slot.querySelector('.card');
        if (card) palette.appendChild(card);
      });
      updateOrderAndVideo();
    });
  </script>
</body>
</html>
